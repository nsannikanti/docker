pipeline {
    agent { label 'docker-label'}

    stages {
        stage('clone') {
            steps {
              checkout scm
            }     
        }
        stage('docker-build') {
            steps {
               sh "sudo chown ubuntu:ubuntu /var/run/docker.sock"
               sh "docker build -t web ."
               sh "docker tag web nsannika/web:4.0"
            }     
        }
         stage('docker-push') {
            steps { 
            //  sh "docker push nsannika/mineimages/web:4.0"
            //   withCredentials([string(credentialsId: 'dockerpassword', variable: 'dockerpass')]) {
            //         sh 'docker login -u "devopsjuly22017" -p "${dockerpass}"'
            //         sh "docker push devopsjuly22017/web:4.0"
            //   }
                withCredentials([string(credentialsId: 'dockerpass', variable: 'dockerpassword')]) {
                        sh 'docker login -u "nsannika" -p "${dockerpassword}"'
                        sh "docker push nsannika/web:4.0"
                }
            }     
        }
    }
}
